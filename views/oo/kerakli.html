<!--<!DOCTYPE html>-->
<!--<html lang="uz">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>Foydalanuvchi Kabineti</title>-->
<!--  <link rel="stylesheet" href="../static/bootstrap-5.3.3-dist/css/bootstrap.min.css">-->
<!--  <style>-->
<!--    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f5f6fa; margin:0; padding:0;}-->
<!--    nav { background-color: #2575fc; color:white; padding:1rem 2rem;}-->
<!--    nav h3 { margin:0;}-->
<!--    .container { margin-top:2rem; max-width:800px;}-->
<!--    .card { padding:1.5rem; border-radius:1rem; background-color:#fff; box-shadow:0 5px 15px rgba(0,0,0,0.1); margin-bottom:2rem;}-->
<!--    .card h4 { margin-bottom:1rem;}-->
<!--    .form-control { margin-bottom:1rem;}-->
<!--    .btn-primary { padding:0.5rem 2rem;}-->
<!--    .logout { text-decoration:none; color:white; float:right;}-->
<!--    .completed { text-decoration: line-through; color: #888;}-->

<!--    .note-item {-->
<!--      display: flex;-->
<!--      align-items: center;-->
<!--      justify-content: space-between;-->
<!--      padding: 0.5rem 1rem;-->
<!--      border: 1px solid #eee;-->
<!--      border-radius: 0.5rem;-->
<!--      margin-bottom: 0.5rem;-->
<!--      background-color: #f9f9f9;-->
<!--    }-->
<!--    .note-left {-->
<!--      display: flex;-->
<!--      align-items: center;-->
<!--      gap: 0.5rem;-->
<!--    }-->
<!--    .note-body {-->
<!--      min-width: 200px;-->
<!--    }-->
<!--    .note-item {-->
<!--      display: flex;-->
<!--      justify-content: space-between; /* checkbox+matn vs delete tugmasi */-->
<!--      align-items: flex-start; /* yuqoridan boshida align */-->
<!--      gap: 0.5rem;-->
<!--      padding: 0.5rem 1rem;-->
<!--      border: 1px solid #eee;-->
<!--      border-radius: 0.5rem;-->
<!--      margin-bottom: 0.5rem;-->
<!--      background-color: #f9f9f9;-->
<!--    }-->

<!--    .note-left {-->
<!--      display: flex;-->
<!--      align-items: flex-start;-->
<!--      gap: 0.5rem;-->
<!--      flex: 1; /* matn kengayishi uchun */-->
<!--    }-->

<!--    .note-body {-->
<!--      word-break: break-word; /* uzun matnni yangi qatorga o‘tkazadi */-->
<!--    }-->

<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--<nav>-->
<!--  <h3>Foydalanuvchi Kabineti-->
<!--    <a href="/logout" class="logout">Chiqish</a>-->
<!--  </h3>-->
<!--</nav>-->
<!--<div class="container">-->

<!--  &lt;!&ndash; Add Note &ndash;&gt;-->
<!--  <div class="card">-->
<!--    <h4>Yangi Ma'lumot Qo'shish</h4>-->
<!--    <form method="post" action="/dashboard/{{.UserId}}">-->
<!--      <textarea name="about" placeholder="Yangi ma'lumot" class="form-control" required></textarea>-->
<!--      <button type="submit" class="btn btn-primary">Saqlash</button>-->
<!--    </form>-->
<!--  </div>-->

<!--  &lt;!&ndash; List Notes &ndash;&gt;-->
<!--  <div class="card">-->
<!--    <h4>Barcha Ma'lumotlar</h4>-->
<!--    {{range .User.Notes}}-->
<!--    <div class="note-item">-->
<!--      <div class="note-left">-->
<!--        <input type="checkbox" class="note-checkbox" data-id="{{.ID}}" {{if .Completed}}checked{{end}}>-->
<!--        <span class="note-body {{if .Completed}}completed{{end}}">{{.Body}}</span>-->
<!--      </div>-->
<!--      <a href="/note/delete/:id" class="btn btn-sm btn-danger note-delete" data-id="{{.ID}}">O‘chirish</a>-->
<!--    </div>-->
<!--    {{else}}-->
<!--    <p>Hozircha ma’lumot yo‘q.</p>-->
<!--    {{end}}-->
<!--  </div>-->
<!--</div>-->

<!--<script>-->
<!--  // Toggle completed (AJAX)-->
<!--  document.querySelectorAll('.note-checkbox').forEach(chk => {-->
<!--    chk.addEventListener('change', function() {-->
<!--      const noteId = this.dataset.id;-->
<!--      fetch('/note/toggle/' + noteId, { method: 'POST' })-->
<!--              .then(res => {-->
<!--                if (res.ok) {-->
<!--                  this.nextElementSibling.classList.toggle('completed');-->
<!--                }-->
<!--              });-->
<!--    });-->
<!--  });-->

<!--  // Delete note (AJAX)-->
<!--  document.querySelectorAll('.note-delete').forEach(btn => {-->
<!--    btn.addEventListener('click', function(e) {-->
<!--      e.preventDefault();-->
<!--      const noteId = this.dataset.id;-->
<!--      fetch('/note/delete/' + noteId, { method: 'POST' })-->
<!--              .then(res => {-->
<!--                if (res.ok) {-->
<!--                  this.closest('.note-item').remove();-->
<!--                }-->
<!--              });-->
<!--    });-->
<!--  });-->
<!--  -->
<!--</script>-->

<!--</body>-->
<!--</html>-->
<!--<!DOCTYPE html>-->
<!--<html lang="uz">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Foydalanuvchi Kabineti</title>-->
<!--    <link rel="stylesheet" href="../static/bootstrap-5.3.3-dist/css/bootstrap.min.css">-->
<!--    <style>-->
<!--        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f5f6fa; margin:0; padding:0;}-->
<!--        nav { background-color: #2575fc; color:white; padding:1rem 2rem;}-->
<!--        nav h3 { margin:0;}-->
<!--        .container { margin-top:2rem; max-width:800px;}-->
<!--        .card { padding:1.5rem; border-radius:1rem; background-color:#fff; box-shadow:0 5px 15px rgba(0,0,0,0.1); margin-bottom:2rem;}-->
<!--        .card h4 { margin-bottom:1rem;}-->
<!--        .form-control { margin-bottom:1rem;}-->
<!--        .btn-primary { padding:0.5rem 2rem;}-->
<!--        .logout { text-decoration:none; color:white; float:right;}-->
<!--        .completed { text-decoration: line-through; color: #888;}-->

<!--        .note-item {-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            align-items: flex-start;-->
<!--            gap: 0.5rem;-->
<!--            padding: 0.5rem 1rem;-->
<!--            border: 1px solid #eee;-->
<!--            border-radius: 0.5rem;-->
<!--            margin-bottom: 0.5rem;-->
<!--            background-color: #f9f9f9;-->
<!--        }-->
<!--        .note-left {-->
<!--            display: flex;-->
<!--            align-items: flex-start;-->
<!--            gap: 0.5rem;-->
<!--            flex: 1;-->
<!--        }-->
<!--        .note-body {-->
<!--            word-break: break-word;-->
<!--        }-->
<!--        .note-actions button {-->
<!--            margin-left: 0.5rem;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<nav>-->
<!--    <h3>Foydalanuvchi Kabineti-->
<!--        <a href="/logout" class="logout">Chiqish</a>-->
<!--    </h3>-->
<!--</nav>-->
<!--<div class="container">-->

<!--    &lt;!&ndash; Add Note &ndash;&gt;-->
<!--    <div class="card">-->
<!--        <h4>Yangi Ma'lumot Qo'shish</h4><form id="addNoteForm" action="/dashboard/{{.UserId}}" method="post" enctype="multipart/form-data">-->
<!--        <textarea name="about" placeholder="Yangi ma'lumot" class="form-control" required></textarea>-->
<!--        <input type="file" name="image" class="form-control mt-2" accept="image/*">-->
<!--        <button type="submit" class="btn btn-primary mt-2">Saqlash</button>-->
<!--    </form>-->

<!--    </div>-->

<!--    &lt;!&ndash; List Notes &ndash;&gt;-->
<!--    <div class="card" id="notesContainer">-->
<!--        <h4>Barcha Ma'lumotlar</h4>-->
<!--        {{range .User.Notes}}-->
<!--        <div class="note-item">-->
<!--            <div class="note-left">-->
<!--                <input type="checkbox" class="note-checkbox" data-id="{{.ID}}" {{if .Completed}}checked{{end}}>-->
<!--                <span class="note-body {{if .Completed}}completed{{end}}">{{.Body}}</span>-->
<!--            </div>-->
<!--            <div class="note-actions">-->
<!--                <a href="/note/delete/{{.ID}}" class="btn btn-sm btn-danger note-delete" data-id="{{.ID}}">O‘chirish</a>-->
<!--                <button class="border-0  note-copy" data-id="{{.ID}}">📋</button>-->
<!--            </div>-->
<!--        </div>-->
<!--        {{else}}-->
<!--        <p>Hozircha ma’lumot yo‘q.</p>-->
<!--        {{end}}-->
<!--    </div>-->
<!--    {{range .User.Notes}}-->
<!--    <div class="note mb-3 p-2 border">-->
<!--        <p>{{.Body}}</p>-->
<!--        {{if .ImagePath}}-->
<!--        <img src="/static/{{.ImagePath}}" alt="Note Image" style="max-width:200px;">-->
<!--        {{end}}-->
<!--    </div>-->
<!--    {{end}}-->

<!--</div>-->

<!--<script>-->
<!--    const notesContainer = document.getElementById('notesContainer');-->

<!--    // Checkbox toggle-->
<!--    function initCheckboxes() {-->
<!--        document.querySelectorAll('.note-checkbox').forEach(chk => {-->
<!--            chk.onchange = function() {-->
<!--                const noteId = this.dataset.id;-->
<!--                fetch('/note/toggle/' + noteId, { method: 'POST' })-->
<!--                    .then(res => {-->
<!--                        if(res.ok){-->
<!--                            this.nextElementSibling.classList.toggle('completed');-->
<!--                        }-->
<!--                    });-->
<!--            };-->
<!--        });-->
<!--    }-->

<!--    // Delete button-->
<!--    function initDeleteButtons() {-->
<!--        document.querySelectorAll('.note-delete').forEach(btn => {-->
<!--            btn.onclick = function(e){-->
<!--                e.preventDefault();-->
<!--                const noteId = this.dataset.id;-->
<!--                fetch('/note/delete/' + noteId, { method: 'POST' })-->
<!--                    .then(res => {-->
<!--                        if(res.ok){-->
<!--                            this.closest('.note-item').remove();-->
<!--                        }-->
<!--                    });-->
<!--            };-->
<!--        });-->
<!--    }-->

<!--    // Copy button-->
<!--    function initCopyButtons() {-->
<!--        document.querySelectorAll('.note-copy').forEach(btn => {-->
<!--            btn.onclick = function() {-->
<!--                const noteItem = this.closest('.note-item');-->
<!--                const text = noteItem.querySelector('.note-body').innerText;-->
<!--                navigator.clipboard.writeText(text).then(() => {-->
<!--                    alert("Matn nusxalandi ✅");-->
<!--                }).catch(err => {-->
<!--                    alert("Xatolik yuz berdi ❌");-->
<!--                });-->
<!--            };-->
<!--        });-->
<!--    }-->

<!--    initCheckboxes();-->
<!--    initDeleteButtons();-->
<!--    initCopyButtons();-->

<!--    // Add new note via AJAX-->
<!--    document.getElementById('addNoteForm').addEventListener('submit', function(e){-->
<!--        e.preventDefault();-->
<!--        const body = this.about.value.trim();-->
<!--        if(!body) return;-->

<!--        fetch(this.action, {-->
<!--            method: 'POST',-->
<!--            headers: {'Content-Type':'application/x-www-form-urlencoded'},-->
<!--            body: new URLSearchParams({ about: body })-->
<!--        }).then(res => res.json())-->
<!--            .then(data => {-->
<!--                if(data.ID){-->
<!--                    const newNoteHTML = `-->
<!--          <div class="note-item">-->
<!--            <div class="note-left">-->
<!--              <input type="checkbox" class="note-checkbox" data-id="${data.ID}">-->
<!--              <span class="note-body">${data.Body}</span>-->
<!--            </div>-->
<!--            <div class="note-actions">-->
<!--              <a href="/note/delete/${data.ID}" class="btn btn-sm btn-danger note-delete" data-id="${data.ID}">O‘chirish</a>-->
<!--              <button class="btn btn-sm btn-success note-copy" data-id="${data.ID}">Nusha olish</button>-->
<!--            </div>-->
<!--          </div>-->
<!--          `;-->
<!--                    notesContainer.insertAdjacentHTML('afterbegin', newNoteHTML);-->
<!--                    this.reset();-->
<!--                    initCheckboxes();-->
<!--                    initDeleteButtons();-->
<!--                    initCopyButtons();-->
<!--                } else {-->
<!--                    alert(data.error || "Xatolik yuz berdi");-->
<!--                }-->
<!--            });-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->
//
//
/
/
/
/
<!--package controllers-->

<!--import (-->
<!--"arxiv/database"-->
<!--"arxiv/models"-->
<!--beego "github.com/beego/beego/v2/server/web"-->
<!--"gorm.io/gorm"-->
<!--"io"-->
<!--"log"-->
<!--"mime/multipart"-->
<!--"os"-->
<!--"path/filepath"-->
<!--"strings"-->
<!--)-->

<!--type DashboardController struct {-->
<!--beego.Controller-->
<!--}-->

<!--func (c *DashboardController) Get() {-->
<!--sessID := c.GetSession("user_id")-->
<!--if sessID == nil {-->
<!--c.Redirect("/login", 302)-->
<!--return-->
<!--}-->
<!--userID := sessID.(uint)-->

<!--var user models.User-->
<!--// Noteslarni ID bo'yicha kamayish tartibida olamiz (so‘nggi tepada)-->
<!--database.DB.Preload("Notes", func(db *gorm.DB) *gorm.DB {-->
<!--return db.Order("id DESC")-->
<!--}).First(&user, userID)-->

<!--c.Data["User"] = user-->
<!--c.Data["UserId"] = user.ID-->
<!--c.TplName = "dashboard.html"-->
<!--}-->

<!--//func (c *DashboardController) Get() {-->
<!--//	sessID := c.GetSession("user_id")-->
<!--//	if sessID == nil {-->
<!--//		c.Redirect("/login", 302)-->
<!--//		return-->
<!--//	}-->
<!--//	userID := sessID.(uint)-->
<!--//-->
<!--//	var user models.User-->
<!--//	database.DB.Preload("Notes").First(&user, userID)-->
<!--//-->
<!--//	c.Data["User"] = user-->
<!--//	c.Data["UserId"] = user.ID-->
<!--//	c.TplName = "dashboard.html"-->
<!--//}-->

<!--func (c *DashboardController) Post() {-->
<!--sessID := c.GetSession("user_id")-->
<!--if sessID == nil {-->
<!--c.Ctx.Output.SetStatus(401)-->
<!--c.Data["json"] = map[string]string{"error": "Unauthorized"}-->
<!--c.ServeJSON()-->
<!--return-->
<!--}-->
<!--userID := sessID.(uint)-->

<!--body := c.GetString("about")-->
<!--if body == "" {-->
<!--c.Ctx.Output.SetStatus(400)-->
<!--c.Data["json"] = map[string]string{"error": "Bo‘sh matn qabul qilinmaydi"}-->
<!--c.ServeJSON()-->
<!--return-->
<!--}-->

<!--// Fayl tanlangan bo'lsa, faqat nomini olish-->
<!--var imagePath string-->
<!--_, header, err := c.GetFile("image")-->
<!--if err == nil && header != nil {-->
<!--filename := filepath.Base(header.Filename)-->
<!--filename = strings.ReplaceAll(filename, " ", "_")-->
<!--imagePath = filename-->
<!--}-->

<!--note := models.Note{-->
<!--UserID:    userID,-->
<!--Body:      body,-->
<!--ImagePath: imagePath,-->
<!--}-->

<!--if err := database.DB.Create(&note).Error; err != nil {-->
<!--c.Ctx.Output.SetStatus(500)-->
<!--c.Data["json"] = map[string]string{"error": "Bazaga yozib bo‘lmadi"}-->
<!--c.ServeJSON()-->
<!--return-->
<!--}-->

<!--c.Data["json"] = map[string]interface{}{-->
<!--"ID":        note.ID,-->
<!--"Body":      note.Body,-->
<!--"ImagePath": note.ImagePath,-->
<!--}-->
<!--c.ServeJSON()-->
<!--}-->